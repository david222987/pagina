<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DavidSoftMarket | Innovaci√≥n 3D & Automatizaci√≥n</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&display=swap');
        
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            scroll-behavior: smooth;
            background-color: #020617;
            color: white;
            overflow-x: hidden;
        }

        #three-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        .glass {
            background: rgba(15, 23, 42, 0.7);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .gradient-text {
            background: linear-gradient(135deg, #60a5fa, #a78bfa, #f472b6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .ai-bubble {
            max-width: 85%;
            margin-bottom: 1rem;
            padding: 1.25rem;
            border-radius: 1.5rem;
            font-size: 0.95rem;
            line-height: 1.6;
            animation: fadeIn 0.3s ease;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .ai-bubble-bot {
            background: rgba(30, 41, 59, 0.8);
            color: #f1f5f9;
            align-self: flex-start;
            border-bottom-left-radius: 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease-out;
        }
        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }

        .card-innovacion {
            background: linear-gradient(145deg, rgba(30, 41, 59, 0.4), rgba(15, 23, 42, 0.6));
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .card-innovacion:hover {
            border-color: #60a5fa;
            transform: scale(1.01);
            box-shadow: 0 20px 40px -15px rgba(59, 130, 246, 0.2);
        }

        .card-portfolio-light {
            background: #ffffff;
            border: 1px solid rgba(0, 0, 0, 0.05);
            transition: all 0.4s ease;
            box-shadow: 0 10px 30px -10px rgba(0,0,0,0.1);
        }
        .card-portfolio-light:hover {
            transform: translateY(-10px);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
            border-color: #3b82f6;
        }

        /* Perfil con borde difuminado solicitado */
        .profile-glow {
            position: relative;
            padding: 4px;
            border-radius: 2rem;
            box-shadow: 0 0 40px -10px rgba(59, 130, 246, 0.5);
        }
        
        .hero-btn {
            position: relative;
            z-index: 20;
        }
    </style>
</head>
<body>

    <!-- Navegaci√≥n -->
    <nav class="fixed w-full z-50 glass">
        <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
            <div class="text-2xl font-extrabold tracking-tighter text-white flex items-center gap-2">
                <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center">
                    <i data-lucide="box" class="w-5 h-5"></i>
                </div>
                <span>David<span class="text-blue-500">SoftMarket</span></span>
            </div>
            <div class="hidden md:flex space-x-8 font-semibold text-slate-400">
                <a href="#inicio" class="hover:text-white transition">Concepto</a>
                <a href="#innovacion" class="hover:text-white transition">Innovaci√≥n</a>
                <a href="#sistemas" class="hover:text-white transition">Proyectos</a>
                <a href="#sobre-mi" class="hover:text-white transition">Sobre m√≠</a>
                <a href="#contacto" class="hover:text-white transition">Contacto</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="inicio" class="relative min-h-screen flex items-center justify-center overflow-hidden">
        <div id="three-canvas"></div>
        <div class="max-w-7xl mx-auto px-6 text-center relative z-10 pointer-events-none">
            <span class="px-4 py-2 bg-blue-500/10 text-blue-400 border border-blue-500/20 rounded-full text-xs font-bold mb-8 inline-block uppercase tracking-[0.3em] backdrop-blur-sm">
                Arquitectura de Ideas & Automatizaci√≥n
            </span>
            <h1 class="text-6xl md:text-9xl font-black mb-8 tracking-tighter leading-[0.9]">
                Pensamos. <br><span class="gradient-text italic">Desarrollamos.</span>
            </h1>
            <p class="text-lg md:text-2xl text-slate-400 max-w-3xl mx-auto mb-12 leading-relaxed">
                Transformamos ideas abstractas en infraestructuras tecnol√≥gicas de alto impacto. 
            </p>
            <div class="flex flex-col md:flex-row justify-center gap-6 pointer-events-auto">
                <a href="#contacto" class="hero-btn px-10 py-5 bg-blue-600 text-white rounded-2xl font-bold text-lg hover:bg-blue-500 transition-all shadow-2xl shadow-blue-600/30 flex items-center justify-center gap-3">
                    Inyectar Tecnolog√≠a <i data-lucide="zap"></i>
                </a>
            </div>
        </div>
    </section>

    <!-- Innovaci√≥n / Porque trabajar con nosotros -->
    <section id="innovacion" class="py-32 bg-slate-950 relative">
        <div class="max-w-7xl mx-auto px-6">
            <div class="grid md:grid-cols-2 gap-20 items-center">
                <div class="reveal">
                    <h2 class="text-4xl md:text-6xl font-black mb-8 leading-tight">La tecnolog√≠a es el <br><span class="text-blue-500">motor del cambio.</span> ‚öôÔ∏è</h2>
                    <p class="text-slate-400 text-xl mb-12 leading-relaxed">
                        No somos una f√°brica de software convencional. Somos un laboratorio de innovaci√≥n donde cada problema es una oportunidad para <strong>automatizar</strong>.
                    </p>
                </div>
                <div class="grid grid-cols-1 gap-6 reveal" style="transition-delay: 0.2s;">
                    <div class="card-innovacion p-10 rounded-3xl">
                        <div class="text-blue-500 mb-6"><i data-lucide="terminal" class="w-12 h-12"></i></div>
                        <h3 class="text-2xl font-bold mb-6 italic">Ideas Disruptivas: ¬øPor qu√© nosotros? üß†</h3>
                        <ul class="space-y-4 text-slate-300">
                            <li class="flex items-start gap-3">
                                <i data-lucide="check-circle-2" class="w-5 h-5 text-blue-500 mt-1 shrink-0"></i>
                                <span><strong>Enfoque en ROI:</strong> Sistemas dise√±ados para retornar valor inmediato.</span>
                            </li>
                            <li class="flex items-start gap-3">
                                <i data-lucide="check-circle-2" class="w-5 h-5 text-blue-500 mt-1 shrink-0"></i>
                                <span><strong>IA Nativa:</strong> No pegamos parches, integramos IA desde el n√∫cleo.</span>
                            </li>
                            <li class="flex items-start gap-3">
                                <i data-lucide="check-circle-2" class="w-5 h-5 text-blue-500 mt-1 shrink-0"></i>
                                <span><strong>Escalabilidad:</strong> Infraestructura que crece sin fricci√≥n.</span>
                            </li>
                            <li class="flex items-start gap-3">
                                <i data-lucide="check-circle-2" class="w-5 h-5 text-blue-500 mt-1 shrink-0"></i>
                                <span><strong>Soporte Proactivo:</strong> Monitoreo inteligente de tus operaciones.</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SISTEMAS REALIZADOS - SECCI√ìN BLANCA -->
    <section id="sistemas" class="py-32 bg-white relative">
        <div class="max-w-7xl mx-auto px-6">
            <div class="mb-20 reveal text-center md:text-left">
                <span class="text-blue-600 font-bold tracking-widest uppercase text-sm block mb-4">Portafolio T√©cnico</span>
                <h2 class="text-5xl md:text-6xl font-black text-slate-900 leading-tight">
                    An√°lisis + Innovaci√≥n = <br>
                    <span class="text-blue-600 italic">Sistemas que impactan.</span>
                </h2>
            </div>

            <div class="grid md:grid-cols-3 gap-8">
                <!-- Proyectos -->
                <div class="card-portfolio-light p-8 rounded-[2.5rem] reveal">
                    <div class="mb-6 w-16 h-16 bg-blue-50 rounded-2xl flex items-center justify-center">
                        <i data-lucide="warehouse" class="w-10 h-10 text-blue-600"></i>
                    </div>
                    <h3 class="text-2xl font-bold mb-3 text-slate-900">Nexus ERP Cloud</h3>
                    <p class="text-slate-600 text-sm mb-6 leading-relaxed">Automatizaci√≥n de log√≠stica con IA predictiva para la gesti√≥n de inventarios en tiempo real.</p>
                    <div class="flex flex-wrap gap-2">
                        <span class="px-3 py-1 bg-slate-100 text-slate-600 text-[10px] font-bold rounded-full uppercase">React</span>
                        <span class="px-3 py-1 bg-slate-100 text-slate-600 text-[10px] font-bold rounded-full uppercase">Node.js</span>
                    </div>
                </div>

                <div class="card-portfolio-light p-8 rounded-[2.5rem] reveal" style="transition-delay: 0.1s;">
                    <div class="mb-6 w-16 h-16 bg-purple-50 rounded-2xl flex items-center justify-center">
                        <i data-lucide="bot-message-square" class="w-10 h-10 text-purple-600"></i>
                    </div>
                    <h3 class="text-2xl font-bold mb-3 text-slate-900">OmniBot 360</h3>
                    <p class="text-slate-600 text-sm mb-6 leading-relaxed">Agente de atenci√≥n al cliente multicanal capaz de resolver el 80% de consultas comunes.</p>
                    <div class="flex flex-wrap gap-2">
                        <span class="px-3 py-1 bg-slate-100 text-slate-600 text-[10px] font-bold rounded-full uppercase">AI/ML</span>
                        <span class="px-3 py-1 bg-slate-100 text-slate-600 text-[10px] font-bold rounded-full uppercase">Python</span>
                    </div>
                </div>

                <div class="card-portfolio-light p-8 rounded-[2.5rem] reveal" style="transition-delay: 0.2s;">
                    <div class="mb-6 w-16 h-16 bg-pink-50 rounded-2xl flex items-center justify-center">
                        <i data-lucide="activity" class="w-10 h-10 text-pink-600"></i>
                    </div>
                    <h3 class="text-2xl font-bold mb-3 text-slate-900">VitalCore App</h3>
                    <p class="text-slate-600 text-sm mb-6 leading-relaxed">Ecosistema de monitoreo m√©dico preventivo conectado con dispositivos IoT de alta precisi√≥n.</p>
                    <div class="flex flex-wrap gap-2">
                        <span class="px-3 py-1 bg-slate-100 text-slate-600 text-[10px] font-bold rounded-full uppercase">IoT</span>
                        <span class="px-3 py-1 bg-slate-100 text-slate-600 text-[10px] font-bold rounded-full uppercase">Cloud</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SOBRE M√ç / EL DESARROLLADOR -->
    <section id="sobre-mi" class="py-32 bg-slate-950 border-t border-white/5">
        <div class="max-w-7xl mx-auto px-6">
            <div class="bg-white/5 rounded-[3rem] p-8 md:p-16 flex flex-col md:flex-row items-center gap-12 reveal">
                <div class="w-full md:w-1/3 flex justify-center">
                    <div class="profile-glow">
                        <div class="bg-slate-900 rounded-[1.8rem] overflow-hidden w-64 h-64 md:w-80 md:h-80 relative border border-blue-500/20">
                            <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?q=80&w=800&auto=format&fit=crop" 
                                 alt="David - Desarrollador Principal" 
                                 class="w-full h-full object-cover grayscale hover:grayscale-0 transition duration-700">
                        </div>
                    </div>
                </div>
                <div class="w-full md:w-2/3 text-left">
                    <span class="text-blue-500 font-bold tracking-[0.3em] uppercase text-sm mb-4 block">Arquitecto de Software</span>
                    <h2 class="text-5xl font-black mb-6">Hola, soy <span class="gradient-text">David.</span></h2>
                    <p class="text-slate-300 text-xl leading-relaxed mb-8">
                        Mi enfoque principal es la <strong>convergencia entre el dise√±o est√©tico y la l√≥gica de automatizaci√≥n robusta</strong>. No solo escribo c√≥digo; dise√±o ecosistemas digitales que permiten a las empresas operar con la m√≠nima fricci√≥n posible. Especializado en arquitecturas escalables, IA aplicada y experiencias 3D inmersivas.
                    </p>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-6">
                        <div><p class="text-3xl font-black text-white">5+</p><p class="text-sm text-slate-500">A√±os de Exp.</p></div>
                        <div><p class="text-3xl font-black text-white">40+</p><p class="text-sm text-slate-500">Sistemas</p></div>
                        <div><p class="text-3xl font-black text-white">100%</p><p class="text-sm text-slate-500">Foco Innovador</p></div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- TESTIMONIOS DE CLIENTES -->
    <section class="py-32 bg-slate-950">
        <div class="max-w-7xl mx-auto px-6">
            <div class="text-center mb-16 reveal">
                <span class="text-blue-500 font-bold tracking-widest uppercase text-xs mb-4 block">Feedback</span>
                <h2 class="text-4xl font-black mb-4">Lo que dicen mis clientes</h2>
                <div class="w-20 h-1 bg-blue-600 mx-auto rounded-full"></div>
            </div>
            <div class="grid md:grid-cols-3 gap-8">
                <div class="testimonial-card p-8 rounded-3xl reveal">
                    <div class="flex gap-1 text-yellow-500 mb-6">
                        <i data-lucide="star" class="w-5 h-5 fill-current"></i>
                        <i data-lucide="star" class="w-5 h-5 fill-current"></i>
                        <i data-lucide="star" class="w-5 h-5 fill-current"></i>
                        <i data-lucide="star" class="w-5 h-5 fill-current"></i>
                        <i data-lucide="star" class="w-5 h-5 fill-current"></i>
                    </div>
                    <p class="text-slate-300 italic mb-8 leading-relaxed">"David transform√≥ completamente nuestro proceso de log√≠stica. La IA predictiva nos ha ahorrado miles de d√≥lares en inventario innecesario."</p>
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 bg-blue-600/20 rounded-full flex items-center justify-center font-bold text-blue-400">RL</div>
                        <div>
                            <p class="font-bold text-white">Ricardo Luna</p>
                            <p class="text-xs text-slate-500 italic">CEO de Nexus Log√≠stica</p>
                        </div>
                    </div>
                </div>
                
                <div class="testimonial-card p-8 rounded-3xl reveal" style="transition-delay: 0.1s;">
                    <div class="flex gap-1 text-yellow-500 mb-6">
                        <i data-lucide="star" class="w-5 h-5 fill-current"></i>
                        <i data-lucide="star" class="w-5 h-5 fill-current"></i>
                        <i data-lucide="star" class="w-5 h-5 fill-current"></i>
                        <i data-lucide="star" class="w-5 h-5 fill-current"></i>
                        <i data-lucide="star" class="w-5 h-5 fill-current"></i>
                    </div>
                    <p class="text-slate-300 italic mb-8 leading-relaxed">"La capacidad de David para entender problemas complejos y simplificarlos a trav√©s de la tecnolog√≠a es simplemente asombrosa."</p>
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 bg-purple-600/20 rounded-full flex items-center justify-center font-bold text-purple-400">SM</div>
                        <div>
                            <p class="font-bold text-white">Sof√≠a M√©ndez</p>
                            <p class="text-xs text-slate-500 italic">Directora de Innovaci√≥n</p>
                        </div>
                    </div>
                </div>

                <div class="testimonial-card p-8 rounded-3xl reveal" style="transition-delay: 0.2s;">
                    <div class="flex gap-1 text-yellow-500 mb-6">
                        <i data-lucide="star" class="w-5 h-5 fill-current"></i>
                        <i data-lucide="star" class="w-5 h-5 fill-current"></i>
                        <i data-lucide="star" class="w-5 h-5 fill-current"></i>
                        <i data-lucide="star" class="w-5 h-5 fill-current"></i>
                        <i data-lucide="star" class="w-5 h-5 fill-current"></i>
                    </div>
                    <p class="text-slate-300 italic mb-8 leading-relaxed">"El ERP que desarroll√≥ es intuitivo y potente. Mi equipo pas√≥ de odiar los sistemas a no poder vivir sin Nexus."</p>
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 bg-pink-600/20 rounded-full flex items-center justify-center font-bold text-pink-400">AG</div>
                        <div>
                            <p class="font-bold text-white">Andr√©s Garc√≠a</p>
                            <p class="text-xs text-slate-500 italic">Gerente de Operaciones</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- CONSULTOR IA -->
    <section id="ia-consultor" class="py-32 bg-slate-950">
        <div class="max-w-4xl mx-auto px-6 text-center">
            <h2 class="text-4xl md:text-5xl font-black text-white mb-6">Laboratorio de Ideas ‚ú®</h2>
            <div class="bg-black/40 border border-white/10 rounded-[2.5rem] overflow-hidden backdrop-blur-2xl text-left shadow-2xl">
                <div id="chat-container" class="h-[400px] overflow-y-auto p-8 flex flex-col space-y-4">
                    <div class="ai-bubble ai-bubble-bot">¬°Hola! Soy la IA de David. Cu√©ntame sobre ese problema que quieres automatizar o esa idea que quieres volver realidad.</div>
                </div>
                <div class="p-6 bg-white/5 border-t border-white/10 flex gap-3">
                    <input type="text" id="user-input" placeholder="Describe tu idea t√©cnica..." class="flex-1 px-6 py-4 bg-white/5 border border-white/10 rounded-2xl outline-none text-white text-sm transition-all focus:border-blue-500">
                    <button onclick="sendMessage()" class="px-8 py-4 bg-white text-slate-950 rounded-2xl hover:bg-blue-600 hover:text-white transition-all font-bold">Analizar</button>
                </div>
            </div>
        </div>
    </section>

    <!-- CONTACTO -->
    <section id="contacto" class="py-32 bg-slate-950 border-t border-white/5">
        <div class="max-w-7xl mx-auto px-6">
            <div class="grid lg:grid-cols-2 gap-16 items-start">
                <div class="reveal text-left">
                    <h2 class="text-5xl md:text-7xl font-black mb-8 leading-tight">Trabaja con nosotros y construye el <span class="text-blue-500 italic">Futuro Hoy.</span></h2>
                    <p class="text-slate-400 text-xl mb-12">Trae tu idea. Nosotros pondremos la tecnolog√≠a necesaria para que tu negocio funcione con total fluidez.</p>
                    
                    <div class="space-y-6">
                        <div class="flex items-center gap-6 group">
                            <div class="w-14 h-14 bg-blue-600/10 rounded-2xl flex items-center justify-center text-blue-500 group-hover:bg-blue-600 group-hover:text-white transition-all"><i data-lucide="phone"></i></div>
                            <div><p class="text-xs text-slate-500 font-bold uppercase tracking-widest">Ll√°manos</p><p class="text-xl font-bold">+51 987 654 321</p></div>
                        </div>
                        <div class="flex items-center gap-6 group">
                            <div class="w-14 h-14 bg-blue-600/10 rounded-2xl flex items-center justify-center text-blue-500 group-hover:bg-blue-600 group-hover:text-white transition-all"><i data-lucide="mail"></i></div>
                            <div><p class="text-xs text-slate-500 font-bold uppercase tracking-widest">Email</p><p class="text-xl font-bold">contacto@davidsoftmarket.com</p></div>
                        </div>
                    </div>
                </div>

                <div class="space-y-6 reveal" style="transition-delay: 0.2s;">
                    <div class="bg-white/5 p-1 rounded-[2.5rem] border border-white/10">
                        <textarea id="contact-msg" placeholder="Describe tu visi√≥n tecnol√≥gica..." rows="6" class="w-full px-8 py-8 bg-transparent border-none rounded-[2.4rem] focus:ring-0 transition outline-none text-white text-xl"></textarea>
                    </div>
                    <div class="flex flex-col gap-4">
                        <button onclick="polishMessage()" class="py-4 border border-blue-500/30 text-blue-400 rounded-2xl hover:bg-blue-500/10 transition font-bold flex items-center justify-center gap-2">
                            <i data-lucide="wand-2" class="w-5 h-5"></i> Refinar Propuesta con IA
                        </button>
                        <button class="py-4 bg-blue-600 text-white font-black text-xl rounded-2xl hover:bg-blue-500 transition-all shadow-xl shadow-blue-600/20">
                            Iniciar Proyecto üõ†Ô∏è
                        </button>
                    </div>
                    <div id="polish-status" class="hidden text-sm text-blue-400 font-bold text-center"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="py-16 bg-black text-white border-t border-white/5">
        <div class="max-w-7xl mx-auto px-6 flex flex-col md:flex-row justify-between items-center gap-8 text-left">
            <div class="text-3xl font-black tracking-tighter">David<span class="text-blue-500">SoftMarket</span></div>
            <p class="text-slate-600 font-medium">¬© 2024 DavidSoftMarket. Innovaci√≥n que impacta.</p>
        </div>
    </footer>

    <script>
        let scene, camera, renderer, particles, starGeo;
        let mouseX = 0, mouseY = 0;
        let targetX = 0, targetY = 0;
        const apiKey = ""; 

        function initThree() {
            const container = document.getElementById('three-canvas');
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 1;
            
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            container.appendChild(renderer.domElement);

            starGeo = new THREE.BufferGeometry();
            const starCount = 6000;
            const posArray = new Float32Array(starCount * 3);
            
            for (let i = 0; i < starCount * 3; i++) {
                posArray[i] = (Math.random() - 0.5) * 10;
            }
            
            starGeo.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
            
            const starMaterial = new THREE.PointsMaterial({
                size: 0.005,
                color: 0x3b82f6,
                transparent: true,
                opacity: 0.8,
                blending: THREE.AdditiveBlending
            });
            
            particles = new THREE.Points(starGeo, starMaterial);
            scene.add(particles);

            window.addEventListener('mousemove', (e) => {
                mouseX = (e.clientX - window.innerWidth / 2) / 100;
                mouseY = (e.clientY - window.innerHeight / 2) / 100;
            });

            animate();
        }

        function animate() {
            requestAnimationFrame(animate);
            
            targetX = mouseX * 0.1;
            targetY = mouseY * 0.1;
            
            particles.rotation.y += 0.002;
            particles.rotation.x += (targetY - particles.rotation.x) * 0.05;
            particles.rotation.y += (targetX - particles.rotation.y) * 0.05;
            
            const positions = starGeo.attributes.position.array;
            for(let i = 0; i < positions.length; i += 3) {
                positions[i+1] += Math.sin(Date.now() * 0.001 + positions[i]) * 0.001;
            }
            starGeo.attributes.position.needsUpdate = true;

            renderer.render(scene, camera);
        }

        async function callGemini(prompt, systemPrompt = "") {
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] }
            };

            for (let i = 0; i < 5; i++) {
                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    const data = await response.json();
                    return data.candidates?.[0]?.content?.parts?.[0]?.text;
                } catch (err) {
                    await new Promise(res => setTimeout(res, Math.pow(2, i) * 1000));
                }
            }
            return "Lo siento, mi conexi√≥n cerebral est√° ocupada. Intenta de nuevo.";
        }

        async function sendMessage() {
            const input = document.getElementById('user-input');
            const text = input.value.trim();
            if(!text) return;
            appendBubble(text, 'user');
            input.value = '';
            const response = await callGemini(text, "Eres el consultor tecnol√≥gico de DavidSoftMarket.");
            appendBubble(response, 'bot');
        }

        async function polishMessage() {
            const textarea = document.getElementById('contact-msg');
            const status = document.getElementById('polish-status');
            const original = textarea.value.trim();
            if(original.length < 5) return;

            status.innerText = "‚ú® Refinando tu visi√≥n tecnol√≥gica...";
            status.classList.remove('hidden');

            const response = await callGemini(original, "Reescribe este mensaje de contacto para que suene profesional y t√©cnico.");
            textarea.value = response;
            status.innerText = "‚ú® ¬°Visi√≥n optimizada!";
            setTimeout(() => status.classList.add('hidden'), 3000);
        }

        function appendBubble(text, side) {
            const chat = document.getElementById('chat-container');
            const div = document.createElement('div');
            div.className = `ai-bubble ai-bubble-${side}`;
            div.innerText = text;
            chat.appendChild(div);
            chat.scrollTop = chat.scrollHeight;
        }

        window.onload = () => {
            initThree();
            lucide.createIcons();
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => { if (entry.isIntersecting) entry.target.classList.add('active'); });
            }, { threshold: 0.1 });
            document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
        };

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>